(this["webpackJsonpcityimage-client"]=this["webpackJsonpcityimage-client"]||[]).push([[0],{1208:function(e,t,n){},1209:function(e,t,n){"use strict";n.r(t);var a=n(4),r=n(0),c=n.n(r),s=n(46),i=n.n(s),o=n(10),u=n(11),l=n(12),d=n(14),p=n(125),h=n(66),j=(n(78),n(34)),m=(n(152),n(63)),b=(n(119),n(61)),f=n(20),O=n.n(f),x=(n(120),n(48)),y=n(38),g=n(1214),v=n(1215),k=n(7),w=n(353),C=n.n(w);function S(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET";return new Promise((function(a,r){var c;"GET"===n?c=C.a.get(e,{params:t}):(c=C.a.post(e,t),console.log("\u6267\u884c\u4e86post")),c.then((function(e){a(e.data)})).catch((function(e){x.b.error("\u8bf7\u6c42\u51fa\u9519\u4e86: "+e.message)}))}))}var N=n(520),I=n.n(N),T=function(e,t){return S("/api/login",{username:e,password:t},"POST")},R=function(e){return S("/api/manage/category/list",{parentId:e})},A=function(e,t){return S("/api/manage/category/update",{categoryId:e,categoryName:t},"POST")},_=function(e,t){return S("/api/manage/category/add",{parentId:e,categoryName:t},"POST")},P=function(e,t){return S("/api/manage/product/list",{pageNum:e,pageSize:t})},D=function(e){var t=e.pageNum,n=e.pageSize,a=e.searchName,r=e.searchType;return S("/api/manage/product/search",Object(k.a)({pageNum:t,pageSize:n},r,a))},U=function(e){return S("/api/manage/category/info",{categoryId:e})},F=function(e,t){return S("/api/manage/product/updateStatus",{productId:e,status:t},"POST")},M=function(e){return S("/api/manage/product/"+(e._id?"update":"add"),e,"POST")},L=function(e){return S("/api/manage/role/add",{roleName:e},"POST")},V=function(e){return S("/api/manage/role/update",e,"POST")},W=function(e){return S("/api/manage/user/"+(e._id?"update":"add"),e,"POST")},K=function(e){var t="http://api.map.baidu.com/telematics/v3/weather?location=".concat(e,"&output=json&ak=3p49MVra6urFRGOT9s8UBWr2");return new Promise((function(e,n){I()(t,{},(function(t,n){if(t||"success"!==n.status)x.b.error("\u5929\u6c14\u83b7\u53d6\u5931\u8d25\uff01");else{var a=n.results[0].weather_data[0],r=a.dayPictureUrl,c=a.weather;e({dayPictureUrl:r,weather:c})}}))}))},z={user:{}},B=n(299),E=n.n(B),J="user_key",q=function(e){E.a.set(J,e)},H=function(){return E.a.get(J)||{}},X=function(){E.a.remove(J)},Y=(n(616),n.p+"static/media/logo.f6487143.png"),G=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).onFinish=function(){var t=Object(y.a)(O.a.mark((function t(n){var a,r,c;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Received values of form: ",n),a=n.username,r=n.password,t.next=4,T(a,r);case 4:0===(c=t.sent).status?(x.b.success("\u767b\u5f55\u6210\u529f"),z.user=c.data,q(c.data),e.props.history.replace("/")):x.b.error(c.msg);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(u.a)(n,[{key:"render",value:function(){var e=z.user;return e&&e._id?Object(a.jsx)(h.a,{to:"/"}):Object(a.jsxs)("div",{className:"login",children:[Object(a.jsxs)("header",{className:"login-header",children:[Object(a.jsx)("img",{src:Y,alt:"logo"}),Object(a.jsx)("h1",{children:"React \u9879\u76ee: \u540e\u53f0\u7ba1\u7406\u7cfb\u7edf"})]}),Object(a.jsxs)("section",{className:"login-content",children:[Object(a.jsx)("h2",{children:"\u7528\u6237\u767b\u5f55"}),Object(a.jsxs)(m.a,{name:"normal_login",className:"login-form",initialValues:{remember:!0},onFinish:this.onFinish,children:[Object(a.jsx)(m.a.Item,{name:"username",rules:[{required:!0,message:"Please input your Username!"},{min:4,message:"\u7528\u6237\u540d\u5fc5\u987b\u5927\u4e8e4!"},{max:16,message:"\u7528\u6237\u540d\u5fc5\u987b\u5c0f\u4e8e8!"},{pattern:/^[a-zA-Z_0-9]+$/,message:"\u7528\u6237\u540d\u5fc5\u987b\u662f\u82f1\u6587\u3001\u6570\u7ec4\u6216\u8005\u4e0b\u5212\u7ebf\u7ec4\u6210!"}],children:Object(a.jsx)(b.a,{prefix:Object(a.jsx)(g.a,{className:"site-form-item-icon",style:{color:"rgba(0,0,0,.5)"}}),placeholder:"\u7528\u6237\u540d"})}),Object(a.jsx)(m.a.Item,{name:"password",rules:[{required:!0,message:"Please input your Password!"}],children:Object(a.jsx)(b.a,{prefix:Object(a.jsx)(v.a,{className:"site-form-item-icon",style:{color:"rgba(0,0,0,.5)"}}),type:"password",placeholder:"\u5bc6\u7801"})}),Object(a.jsxs)(m.a.Item,{children:[Object(a.jsx)(j.a,{type:"primary",htmlType:"submit",className:"login-form-button",children:"Log in"}),"Or ",Object(a.jsx)("a",{href:"",children:"register now!"})]})]})]})]})}}]),n}(r.Component),Q=(n(697),n(200)),Z=(n(205),n(89)),$=n(1226);n(700);function ee(e){if(!e)return"";var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}var te=n(1216),ne=n(1217),ae=n(1218),re=n(1219),ce=n(1220),se=n(1221),ie=n(1222),oe=n(1223),ue=n(1224),le=n(1225),de=[{title:"\u9996\u9875",key:"/home",icon:"HomeOutlined",icon1:te.a,isPublic:!0},{title:"\u5546\u54c1",key:"/products",icon:"AppstoreOutlined",icon1:ne.a,children:[{title:"\u54c1\u7c7b\u7ba1\u7406",key:"/category",icon:"BarsOutlined",icon1:ae.a},{title:"\u5546\u54c1\u7ba1\u7406",key:"/product",icon:"ToolOutlined",icon1:re.a}]},{title:"\u7528\u6237\u7ba1\u7406",key:"/user",icon:"UserOutlined",icon1:g.a},{title:"\u89d2\u8272\u7ba1\u7406",key:"/role",icon:"SafetyOutlined",icon1:ce.a},{title:"\u56fe\u5f62\u56fe\u8868",key:"/charts",icon:"AreaChartOutlined",icon1:se.a,children:[{title:"\u67f1\u5f62\u56fe",key:"/charts/bar",icon:"BarChartOutlined",icon1:ie.a},{title:"\u6298\u7ebf\u56fe",key:"/charts/line",icon:"LineChartOutlined",icon1:oe.a},{title:"\u997c\u56fe",key:"/charts/pie",icon:"PieChartOutlined",icon1:ue.a}]},{title:"\u8ba2\u5355\u7ba1\u7406",key:"/order",icon:"WindowsOutlined",icon1:le.a}],pe=n(5);n(701);function he(e){return Object(a.jsx)("button",Object(pe.a)(Object(pe.a)({},e),{},{className:"link-button"}))}var je=n(196),me="set_head_title",be=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,c=new Array(r),s=0;s<r;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).state={currentTime:ee(Date.now()),dayPictureUrl:"",weather:""},e.getTime=function(){e.intervalId=setInterval((function(){e.setState({currentTime:ee(Date.now())})}),1e3)},e.getWeather=Object(y.a)(O.a.mark((function t(){var n,a,r;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,K("\u5317\u4eac");case 2:n=t.sent,a=n.dayPictureUrl,r=n.weather,e.setState({dayPictureUrl:a,weather:r});case 6:case"end":return t.stop()}}),t)}))),e.logout=function(){Z.a.confirm({title:"\u9000\u51fa\u767b\u5f55\uff1f",icon:Object(a.jsx)($.a,{}),okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:function(){X(),z.user={},e.props.history.replace("/login")}})},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.getTime(),this.getWeather()}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervalId)}},{key:"render",value:function(){var e=z.user.username,t=this.state,n=t.currentTime,r=t.dayPictureUrl,c=t.weather,s=this.props.headTitle;return Object(a.jsxs)("div",{className:"header",children:[Object(a.jsxs)("div",{className:"header-top",children:[Object(a.jsxs)("span",{children:["\u6b22\u8fce,",e]}),Object(a.jsx)(he,{onClick:this.logout,children:"\u9000\u51fa"})]}),Object(a.jsxs)("div",{className:"header-bottom",children:[Object(a.jsx)("div",{className:"header-bottom-left",children:s}),Object(a.jsxs)("div",{className:"header-bottom-right",children:[Object(a.jsx)("span",{children:n}),Object(a.jsx)("img",{src:r,alt:""}),Object(a.jsx)("span",{children:c})]})]})]})}}]),n}(r.Component),fe=Object(je.b)((function(e){return{headTitle:e.headTitle}}))(Object(h.g)(be)),Oe=(n(713),n(108)),xe=(n(715),Oe.a.SubMenu),ye=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,c=new Array(r),s=0;s<r;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).hasAuth=function(e){var t=z.user,n=t.username,a=t.role.menus;return!("admin"!==n&&!e.isPublic&&-1===a.indexOf(e.key))||(e.children?!!e.children.find((function(e){return-1!==a.indexOf(e.key)})):void 0)},e.getMenuNodes=function(t){return t.map((function(t){var n=e.props.location.pathname;if(e.hasAuth(t))return t.children?(t.children.find((function(e){return 0===n.indexOf(e.key)}))&&(e.openKey=t.key),Object(a.jsx)(xe,{title:Object(a.jsxs)("span",{children:[Object(a.jsx)(t.icon1,{}),Object(a.jsx)("span",{children:t.title})]}),children:e.getMenuNodes(t.children)},t.key)):(t.key!==n&&0!==n.indexOf(t.key)||e.props.setTitle(t.title),Object(a.jsx)(Oe.a.Item,{children:Object(a.jsxs)(p.b,{to:t.key,onClick:function(){return e.props.setTitle(t.title)},children:[Object(a.jsx)(t.icon1,{}),Object(a.jsx)("span",{children:t.title})]})},t.key))}))},e}return Object(u.a)(n,[{key:"componentWillMount",value:function(){this.menuNodes=this.getMenuNodes(de)}},{key:"render",value:function(){var e=this.props.location.pathname,t=this.openKey;return 0===e.indexOf("/product")&&(e="/product"),Object(a.jsxs)("div",{className:"left-nav",children:[Object(a.jsxs)(p.b,{to:"/",className:"logo-link",children:[Object(a.jsx)("img",{src:Y,alt:"logo"}),Object(a.jsx)("h1",{children:"\u540e\u53f0\u670d\u52a1"})]}),Object(a.jsx)(Oe.a,{selectedKeys:[e],defaultOpenKeys:[t],mode:"inline",theme:"dark",children:this.menuNodes})]})}}]),n}(r.Component),ge=Object(je.b)((function(e){return{headTitle:e.headTitle}}),{setTitle:function(e){return{type:me,data:e}}})(Object(h.g)(ye)),ve=(n(722),n(201)),ke=(n(117),n(60)),we=(n(1210),n(300)),Ce=(n(1211),n(553)),Se=(n(730),n(199)),Ne=[{month:"Jan",city:"Tokyo",temperature:7},{month:"Jan",city:"London",temperature:3.9},{month:"Feb",city:"Tokyo",temperature:6.9},{month:"Feb",city:"London",temperature:4.2},{month:"Mar",city:"Tokyo",temperature:9.5},{month:"Mar",city:"London",temperature:5.7},{month:"Apr",city:"Tokyo",temperature:14.5},{month:"Apr",city:"London",temperature:8.5},{month:"May",city:"Tokyo",temperature:18.4},{month:"May",city:"London",temperature:11.9},{month:"Jun",city:"Tokyo",temperature:21.5},{month:"Jun",city:"London",temperature:15.2},{month:"Jul",city:"Tokyo",temperature:25.2},{month:"Jul",city:"London",temperature:17},{month:"Aug",city:"Tokyo",temperature:26.5},{month:"Aug",city:"London",temperature:16.6},{month:"Sep",city:"Tokyo",temperature:23.3},{month:"Sep",city:"London",temperature:14.2},{month:"Oct",city:"Tokyo",temperature:18.3},{month:"Oct",city:"London",temperature:10.3},{month:"Nov",city:"Tokyo",temperature:13.9},{month:"Nov",city:"London",temperature:6.6},{month:"Dec",city:"Tokyo",temperature:9.6},{month:"Dec",city:"London",temperature:4.8}];var Ie=function(){return Object(a.jsx)("div",{style:{float:"right",width:600,height:300},children:Object(a.jsx)(Se.Chart,{scale:{temperature:{min:0}},padding:[10,20,50,40],autoFit:!0,height:280,data:Ne,children:Object(a.jsx)(Se.LineAdvance,{point:{size:3},shape:"smooth",position:"month*temperature",color:"city"})})})},Te=[{year:"1951 \u5e74",sales:38},{year:"1952 \u5e74",sales:52},{year:"1956 \u5e74",sales:61},{year:"1957 \u5e74",sales:45},{year:"1958 \u5e74",sales:48},{year:"1959 \u5e74",sales:38},{year:"1960 \u5e74",sales:38},{year:"1962 \u5e74",sales:38}];var Re=function(){return Object(a.jsx)("div",{style:{width:"100%",marginTop:30},children:Object(a.jsx)(Se.Chart,{height:238,forceFit:!0,data:Te,children:Object(a.jsx)(Se.Interval,{position:"year*sales"})})})},Ae=n(109),_e=n.n(Ae),Pe=n(1227),De=n(1228),Ue=n(1229),Fe=Ce.a.RangePicker,Me="YYYY/MM/DD",Le=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={isVisited:!0},e.handleChange=function(t){return function(){return e.setState({isVisited:t})}},e}return Object(u.a)(n,[{key:"render",value:function(){var e=this.state.isVisited;return Object(a.jsxs)("div",{className:"home",children:[Object(a.jsxs)(ke.a,{className:"home-card",title:"\u5546\u54c1\u603b\u91cf",extra:Object(a.jsx)(Pe.a,{}),style:{width:250,height:300},children:[Object(a.jsx)(we.a,{value:11,precision:0,valueStyle:{color:"#000000"},prefix:"\u603b\u4f53\u8d8b\u52bf",suffix:Object(a.jsxs)("div",{children:["%",Object(a.jsx)(De.a,{})]})}),Object(a.jsx)(we.a,{title:"Active",value:11.28,precision:2,valueStyle:{color:"#3f8600",fontSize:15},prefix:"\u5468\u540c\u6bd4",suffix:Object(a.jsxs)("div",{children:["%",Object(a.jsx)(De.a,{})]})}),Object(a.jsx)(we.a,{title:"Idle",value:9.3,precision:2,valueStyle:{color:"#cf1322",fontSize:15},prefix:"\u5468\u540c\u6bd4",suffix:Object(a.jsxs)("div",{children:["%",Object(a.jsx)(Ue.a,{})]})})]}),Object(a.jsx)(Ie,{}),Object(a.jsxs)(ke.a,{className:"home-content",title:Object(a.jsxs)("div",{className:"home-menu",children:[Object(a.jsx)("span",{className:e?"home-menu-active home-menu-visited":"home-menu-visited",onClick:this.handleChange(!0),children:"\u8bbf\u95ee\u91cf"}),Object(a.jsx)("span",{className:e?"":"home-menu-active",onClick:this.handleChange(!1),children:"\u9500\u552e\u91cf"})]}),extra:Object(a.jsx)(Fe,{defaultValue:[_e()("2020/11/10",Me),_e()("2019/11/24",Me)],format:Me}),children:[Object(a.jsx)(ke.a,{className:"home-table-left",title:e?"\u8bbf\u95ee\u8d8b\u52bf":"\u9500\u552e\u8d8b\u52bf",bodyStyle:{padding:0,height:275},extra:Object(a.jsx)(Pe.a,{}),children:Object(a.jsx)(Re,{})}),Object(a.jsx)(ke.a,{title:"\u4efb\u52a1",extra:Object(a.jsx)(Pe.a,{}),className:"home-table-right",children:Object(a.jsxs)(ve.a,{children:[Object(a.jsx)(ve.a.Item,{color:"green",children:"\u65b0\u7248\u672c\u8fed\u4ee3\u4f1a"}),Object(a.jsx)(ve.a.Item,{color:"green",children:"\u5b8c\u6210\u7f51\u7ad9\u8bbe\u8ba1\u521d\u7248"}),Object(a.jsxs)(ve.a.Item,{color:"red",children:[Object(a.jsx)("p",{children:"\u8054\u8c03\u63a5\u53e3"}),Object(a.jsx)("p",{children:"\u529f\u80fd\u9a8c\u6536"})]}),Object(a.jsxs)(ve.a.Item,{children:[Object(a.jsx)("p",{children:"\u767b\u5f55\u529f\u80fd\u8bbe\u8ba1"}),Object(a.jsx)("p",{children:"\u6743\u9650\u9a8c\u8bc1"}),Object(a.jsx)("p",{children:"\u9875\u9762\u6392\u7248"})]})]})})]})]})}}]),n}(r.Component),Ve=(n(270),n(144)),We=n(1230),Ke=n(1231),ze=(n(206),n(76)),Be=m.a.Item,Ee=ze.a.Option,Je=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).formRef=c.a.createRef(),e}return Object(u.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return e.parentId!=this.props.parentId&&(this.formRef.current.setFieldsValue({parentId:e.parentId}),console.log("parentId\u5bf9\u6bd4",e.parentId),!0)}},{key:"componentDidMount",value:function(){var e=this.formRef.current;this.props.setForm(e)}},{key:"render",value:function(){var e=this.props,t=e.categorys;e.parentId;return Object(a.jsxs)(m.a,{ref:this.formRef,initialValues:{parentId:"0"},children:[Object(a.jsx)(Be,{name:"parentId",children:Object(a.jsxs)(ze.a,{children:[Object(a.jsx)(Ee,{value:"0",children:"\u4e00\u7ea7\u5206\u7c7b"}),t.map((function(e){return Object(a.jsx)(Ee,{value:e._id,children:e.name})}))]})}),Object(a.jsx)(Be,{name:"categoryName",rules:[{required:!0,message:"\u5206\u7c7b\u540d\u79f0\u5fc5\u987b\u8f93\u5165"}],children:Object(a.jsx)(b.a,{placeholder:"\u8bf7\u8f93\u5165\u5206\u7c7b\u540d\u79f0"})})]})}}]),n}(r.Component),qe=m.a.Item,He=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).formRef=c.a.createRef(),e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this.formRef.current;this.props.setForm(e)}},{key:"shouldComponentUpdate",value:function(e,t){return e.categoryName!=this.props.categoryName&&(this.formRef.current.setFieldsValue({categoryName:e.categoryName}),!0)}},{key:"render",value:function(){var e=this.props.categoryName;return Object(a.jsx)(m.a,{ref:this.formRef,initialValues:{categoryName:e},children:Object(a.jsx)(qe,{name:"categoryName",rules:[{required:!0,message:"\u5206\u7c7b\u540d\u79f0\u5fc5\u987b\u8f93\u5165"}],children:Object(a.jsx)(b.a,{placeholder:"\u8bf7\u8f93\u5165\u5206\u7c7b\u540d\u79f0"})})})}}]),n}(r.Component),Xe=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,c=new Array(r),s=0;s<r;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).state={loading:!1,categorys:[],subCategorys:[],parentId:"0",parentName:"",showState:0},e.initColums=function(){e.columns=[{title:"\u5206\u7c7b\u7684\u540d\u79f0",dataIndex:"name",key:"name",width:"75%"},{title:"\u64cd\u4f5c",render:function(t){return Object(a.jsxs)("span",{children:[Object(a.jsx)(he,{onClick:function(){return e.showAddSubCatory(t)},children:"\u4fee\u6539\u5206\u7c7b"}),"0"===e.state.parentId?Object(a.jsx)(he,{onClick:function(){return e.showSubCategorys(t)},children:"\u67e5\u770b\u5b50\u5206\u7c7b"}):null]})}}]},e.getCategorys=function(){var t=Object(y.a)(O.a.mark((function t(n){var a,r;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({loading:!0}),n=n||e.state.parentId,t.next=4,R(n);case 4:a=t.sent,e.setState({loading:!1}),0===a.status?(r=a.data,"0"===n?e.setState({categorys:r}):e.setState({subCategorys:r})):x.b.error("\u83b7\u53d6\u5206\u7c7b\u5217\u8868\u5931\u8d25");case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.showSubCategorys=function(t){e.setState({parentId:t._id,parentName:t.name},(function(){e.getCategorys(),console.log("state",e.state)}))},e.showCategorys=function(){e.setState({parentId:"0",subCategorys:[],parentName:""})},e.addCategory=function(){console.log("addCategory()"),e.form.validateFields(["parentId","categoryName"]).then(function(){var t=Object(y.a)(O.a.mark((function t(n){var a,r;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({showState:0}),a=n.parentId,r=n.categoryName,console.log("re0",n),e.form.resetFields(["categoryName"]),t.next=6,_(a,r);case 6:0===t.sent.status&&(a===e.state.parentId?e.getCategorys():"0"===a&&e.getCategorys("0"));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},e.updateSubCategory=function(){console.log("updateSubCategory()"),e.form.validateFields(["categoryName"]).then(function(){var t=Object(y.a)(O.a.mark((function t(n){var a,r,c;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({showState:0}),a=e.category._id,r=n.categoryName,e.form.resetFields(),t.next=6,A(a,r);case 6:0===(c=t.sent).status&&(console.log("\u6210\u529f\u4e86",c),e.getCategorys());case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},e.showAdd=function(){e.setState({showState:1})},e.showAddSubCatory=function(t){e.category=t,e.setState({showState:2})},e.handleCancel=function(){e.setState({showState:0})},e}return Object(u.a)(n,[{key:"componentWillMount",value:function(){this.initColums()}},{key:"componentDidMount",value:function(){this.getCategorys()}},{key:"render",value:function(){var e=this,t=this.state,n=t.categorys,r=t.loading,c=t.subCategorys,s=t.parentId,i=t.parentName,o=t.showState,u=this.category||{},l="0"===s?"\u4e00\u7ea7\u5206\u7c7b\u5217\u8868":Object(a.jsxs)("span",{children:[Object(a.jsx)(he,{onClick:this.showCategorys,children:"\u4e00\u7ea7\u5206\u7c7b\u5217\u8868"}),Object(a.jsx)(We.a,{}),Object(a.jsx)("span",{children:i})]}),d=Object(a.jsx)(j.a,{type:"primary",onClick:this.showAdd,children:Object(a.jsxs)("span",{children:[Object(a.jsx)(Ke.a,{}),"\u6dfb\u52a0"]})});return Object(a.jsxs)(ke.a,{title:l,extra:d,children:[Object(a.jsx)(Ve.a,{rowKey:"_id",columns:this.columns,bordered:!0,loading:r,dataSource:"0"===s?n:c,pagination:{defaultPageSize:5,showQuickJumper:!0}}),Object(a.jsx)(Z.a,{title:"\u4e00\u7ea7\u5206\u7c7b",visible:1===o,onOk:this.addCategory,onCancel:this.handleCancel,children:Object(a.jsx)(Je,{categorys:n,parentId:s,setForm:function(t){e.form=t}})}),Object(a.jsx)(Z.a,{title:"\u66f4\u65b0\u5206\u7c7b",visible:2===o,onOk:this.updateSubCategory,onCancel:this.handleCancel,children:Object(a.jsx)(He,{categoryName:u.name,setForm:function(t){e.form=t}})})]})}}]),n}(r.Component),Ye="http://localhost:5000/upload/",Ge=(n(776),ze.a.Option),Qe=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var r=arguments.length,c=new Array(r),s=0;s<r;s++)c[s]=arguments[s];return(e=t.call.apply(t,[this].concat(c))).state={loading:!1,products:[],total:0,searchName:"",searchType:"productName"},e.initColums=function(){e.columns=[{title:"\u5546\u54c1\u540d\u79f0",dataIndex:"name",key:"name"},{title:"\u5546\u54c1\u63cf\u8ff0",dataIndex:"desc",key:"desc"},{title:"\u4ef7\u683c",dataIndex:"price",render:function(e){return"\xa5"+e}},{title:"\u64cd\u4f5c",width:100,render:function(t){var n=t.status,r=t._id,c=1===n?2:1;return Object(a.jsxs)("span",{children:[Object(a.jsx)(j.a,{type:"primary",onClick:function(){return e.updateStatus(r,c)},children:1===n?"\u4e0a\u67b6":"\u4e0b\u67b6"}),Object(a.jsx)("span",{children:1===n?"\u5728\u552e":"\u5df2\u4e0b\u67b6"})]})}},{title:"\u72b6\u6001",width:100,render:function(t){return Object(a.jsxs)("span",{children:[Object(a.jsx)(he,{onClick:function(){return e.props.history.push("/product/details",{product:t})},children:"\u8be6\u60c5"}),Object(a.jsx)(he,{onClick:function(){return e.props.history.push("/product/addupdate",t)},children:"\u4fee\u6539"})]})}}]},e.updateStatus=function(){var t=Object(y.a)(O.a.mark((function t(n,a){return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,F(n,a);case 2:0===t.sent.status&&(x.b.success("\u66f4\u65b0\u5546\u54c1\u72b6\u6001\u6210\u529f"),e.getProducts(e.pageNum));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),e.getProducts=function(){var t=Object(y.a)(O.a.mark((function t(n){var a,r,c,s,i,o,u;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.pageNum=n,e.setState({loading:!0}),a=e.state,r=a.searchName,c=a.searchType,!r){t.next=9;break}return t.next=6,D({pageNum:n,pageSize:3,searchName:r,searchType:c});case 6:s=t.sent,t.next=12;break;case 9:return t.next=11,P(n,3);case 11:s=t.sent;case 12:e.setState({loading:!1}),0===s.status&&(i=s.data,o=i.list,u=i.total,e.setState({products:o,total:u}));case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(u.a)(n,[{key:"componentWillMount",value:function(){this.initColums()}},{key:"componentDidMount",value:function(){this.getProducts(1)}},{key:"render",value:function(){var e=this,t=this.state,n=t.products,r=t.loading,c=t.total,s=t.searchName,i=t.searchType,o=Object(a.jsxs)("span",{children:[Object(a.jsxs)(ze.a,{value:i,style:{width:"150px"},onChange:function(t){return e.setState({searchType:t})},children:[Object(a.jsx)(Ge,{value:"productName",children:"\u6309\u540d\u79f0\u641c\u7d22"}),Object(a.jsx)(Ge,{value:"productDesc",children:"\u6309\u63cf\u8ff0\u641c\u7d22"})]}),Object(a.jsx)(b.a,{style:{width:"150px",margin:"0 15px"},value:s,onChange:function(t){return e.setState({searchName:t.target.value})}}),Object(a.jsx)(j.a,{type:"primary",onClick:function(){return e.getProducts(1)},children:"\u641c\u7d22"})]}),u=Object(a.jsxs)(j.a,{type:"primary",onClick:function(){return e.props.history.push("/product/addupdate")},children:[Object(a.jsx)(Ke.a,{}),"\u6dfb\u52a0\u5546\u54c1"]});return Object(a.jsx)(ke.a,{title:o,extra:u,children:Object(a.jsx)(Ve.a,{rowKey:"_id",columns:this.columns,bordered:!0,loading:r,dataSource:n,pagination:{total:c,defaultPageSize:3,showQuickJumper:!0,current:this.pageNum,onChange:this.getProducts}})})}}]),n}(r.Component),Ze=(n(777),n(555)),$e=n(16),et=n(39),tt=n(1232),nt=(n(1212),n(554));function at(e){return new Promise((function(t,n){var a=new FileReader;a.readAsDataURL(e),a.onload=function(){return t(a.result)},a.onerror=function(e){return n(e)}}))}var rt=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var a;Object(o.a)(this,n),(a=t.call(this,e)).getImgs=function(){return a.state.fileList.map((function(e){return e.name}))},a.handleCancel=function(){return a.setState({previewVisible:!1})},a.handlePreview=function(){var e=Object(y.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("handlePreview()",t),t.url||t.preview){e.next=5;break}return e.next=4,at(t.originFileObj);case 4:t.preview=e.sent;case 5:a.setState({previewImage:t.url||t.preview,previewVisible:!0,previewTitle:t.name||t.url.substring(t.url.lastIndexOf("/")+1)});case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleChange=function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.file,r=t.fileList,console.log("handleChange()",n,n.status,r.length,n===r[r.length-1]),a.setState({fileList:r}),"done"!==n.status){e.next=8;break}0===(c=n.response).status?((n=r[r.length-1]).name=c.data.name,n.url=c.data.url):x.b.error("\u56fe\u7247\u4e0a\u4f20\u5931\u8d25"),e.next=13;break;case 8:if("removed"!==n.status){e.next=13;break}return e.next=11,S("/api/manage/img/delete",{name:n.name},"POST");case 11:0===e.sent.status?x.b.success("\u56fe\u7247\u5220\u9664\u6210\u529f\uff01"):x.b.error("\u56fe\u7247\u5220\u9664\u5931\u8d25\uff01");case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var r=a.props.imgs,c=[];return r&&r.length>0&&(c=r.map((function(e,t){return{uid:-t,name:e,status:"done",url:Ye+e}}))),a.state={previewVisible:!1,previewImage:"",previewTitle:"",fileList:c},a}return Object(u.a)(n,[{key:"render",value:function(){var e=this.state,t=e.previewVisible,n=e.previewImage,r=e.fileList,c=e.previewTitle,s=Object(a.jsxs)("div",{children:[Object(a.jsx)(Ke.a,{}),Object(a.jsx)("div",{style:{marginTop:8},children:"Upload"})]});return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(nt.a,{action:"/manage/img/upload",accept:"image/*",name:"image",listType:"picture-card",fileList:r,onPreview:this.handlePreview,onChange:this.handleChange,children:r.length>=4?null:s}),Object(a.jsx)(Z.a,{visible:t,title:c,footer:null,onCancel:this.handleCancel,children:Object(a.jsx)("img",{alt:"example",style:{width:"100%"},src:n})})]})}}]),n}(c.a.Component),ct=n(170),st=n(541),it=n(542),ot=n.n(it),ut=n(543),lt=n.n(ut),dt=(n(885),function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var a;Object(o.a)(this,n),(a=t.call(this,e)).onEditorStateChange=function(e){a.setState({editorState:e})},a.getDetail=function(){return ot()(Object(ct.convertToRaw)(a.state.editorState.getCurrentContent()))};var r=a.props.detail;if(r){var c=lt()(r),s=ct.ContentState.createFromBlockArray(c.contentBlocks),i=ct.EditorState.createWithContent(s);a.state={editorState:i}}else a.state={editorState:ct.EditorState.createEmpty()};return a}return Object(u.a)(n,[{key:"uploadImageCallBack",value:function(e){return new Promise((function(t,n){var a=new XMLHttpRequest;a.open("POST","/manage/img/upload"),a.setRequestHeader("Authorization","Client-ID XXXXX");var r=new FormData;r.append("image",e),a.send(r),a.addEventListener("load",(function(){var e=JSON.parse(a.responseText).data.url;t({data:{link:e}})})),a.addEventListener("error",(function(){var e=JSON.parse(a.responseText);n(e)}))}))}},{key:"render",value:function(){var e=this.state.editorState;return Object(a.jsx)("div",{children:Object(a.jsx)(st.Editor,{editorState:e,editorStyle:{border:"1px solid black",minHeight:200,paddingLeft:10},onEditorStateChange:this.onEditorStateChange,toolbar:{inline:{inDropdown:!0},list:{inDropdown:!0},textAlign:{inDropdown:!0},link:{inDropdown:!0},history:{inDropdown:!0},image:{uploadCallback:this.uploadImageCallBack,alt:{present:!0,mandatory:!0}}}})})}}]),n}(r.Component)),pt=m.a.Item,ht=b.a.TextArea,jt=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={options:[]},a.validatePrice=function(e,t){return 1*t>=0?Promise.resolve():Promise.reject("\u4ef7\u683c\u5fc5\u987b\u5927\u4e8e0!")},a.submit=function(){a.formRef.current.validateFields(["name","desc","price","categoryIds"]).then(function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,c,s,i,o,u,l,d;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("validateFields",t),n=t.name,r=t.desc,c=t.price,1===(s=t.categoryIds).length?(i="0",o=s[0]):(i=s[0],o=s[1]),u=a.pw.current.getImgs(),l=a.editor.current.getDetail(),d={name:n,desc:r,price:c,imgs:u,detail:l,pCategoryId:i,categoryId:o},console.log("product",d),a.isUpdate&&(d._id=a.product._id),e.next=10,M(d);case 10:0===e.sent.status?(x.b.success("".concat(a.isUpdate?"\u66f4\u65b0":"\u6dfb\u52a0","\u5546\u54c1\u6210\u529f!")),a.props.history.goBack()):x.b.error("".concat(a.isUpdate?"\u66f4\u65b0":"\u6dfb\u52a0","\u5546\u54c1\u5931\u8d25!"));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},a.loadData=function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t[0]).loading=!0,e.next=4,a.getCategorys(n.value);case 4:r=e.sent,n.loading=!1,r&&r.length>0?(c=r.map((function(e){return{label:e.name,value:e._id,isLeaf:!0}})),n.children=c):n.isLeaf=!0,a.setState({options:Object($e.a)(a.state.options)});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.initOptions=function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,c,s,i,o,u;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.map((function(e){return{value:e._id,label:e.name,isLeaf:!1}})),r=Object(et.a)(a),c=r.isUpdate,s=r.product,i=s.pCategoryId,!c||"0"===i){e.next=10;break}return e.next=6,a.getCategorys(i);case 6:o=e.sent,u=o.map((function(e){return{label:e.name,value:e._id,isLeaf:!0}})),n.find((function(e){return e.value===i})).children=u;case 10:a.setState({options:n});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.getCategorys=function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R(t);case 2:if(0!==(n=e.sent).status){e.next=10;break}if(r=n.data,"0"!==t){e.next=9;break}a.initOptions(r),e.next=10;break;case 9:return e.abrupt("return",r);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.formRef=c.a.createRef(),a.pw=c.a.createRef(),a.editor=c.a.createRef(),a}return Object(u.a)(n,[{key:"componentWillMount",value:function(){var e=this.props.location.state;this.isUpdate=!!e,this.product=e||{}}},{key:"componentDidMount",value:function(){this.getCategorys("0")}},{key:"render",value:function(){var e=this,t=this.isUpdate,n=this.product,r=n.pCategoryId,c=n.categoryId,s=n.imgs,i=n.detail,o=[];t&&("0"===r||o.push(r),o.push(c));var u=Object(a.jsxs)("span",{children:[Object(a.jsx)(he,{onClick:function(){return e.props.history.goBack()},children:Object(a.jsx)(tt.a,{})}),Object(a.jsx)("span",{style:{marginLeft:10},children:t?"\u4fee\u6539\u5546\u54c1":"\u6dfb\u52a0\u5546\u54c1"})]});return Object(a.jsx)(ke.a,{title:u,children:Object(a.jsxs)(m.a,Object(pe.a)(Object(pe.a)({},{labelCol:{span:2},wrapperCol:{span:8}}),{},{ref:this.formRef,initialValues:{name:n.name,desc:n.desc,price:n.price,categoryIds:o},children:[Object(a.jsx)(pt,{label:"\u5546\u54c1\u540d\u79f0\uff1a",name:"name",rules:[{required:!0,message:"\u5546\u54c1\u540d\u79f0\u5fc5\u987b\u8f93\u5165!"}],children:Object(a.jsx)(b.a,{placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0"})}),Object(a.jsx)(pt,{label:"\u5546\u54c1\u63cf\u8ff0\uff1a",name:"desc",rules:[{required:!0,message:"\u5546\u54c1\u63cf\u8ff0\u5fc5\u987b\u8f93\u5165!"}],children:Object(a.jsx)(ht,{placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u63cf\u8ff0",autoSize:{minRows:2,maxRows:6}})}),Object(a.jsx)(pt,{label:"\u5546\u54c1\u4ef7\u683c\uff1a",name:"price",rules:[{required:!0,message:"\u5fc5\u987b\u8f93\u5165\u5546\u54c1\u4ef7\u683c"},{validator:this.validatePrice}],children:Object(a.jsx)(b.a,{type:"number",placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u4ef7\u683c",addonAfter:"\u5143"})}),Object(a.jsx)(pt,{label:"\u5546\u54c1\u5206\u7c7b\uff1a",name:"categoryIds",rules:[{required:!0,message:"\u5fc5\u987b\u6307\u5b9a\u5546\u54c1\u5206\u7c7b!"}],children:Object(a.jsx)(Ze.a,{placeholder:"\u8bf7\u8f93\u5165\u5546\u54c1\u5206\u7c7b",options:this.state.options,loadData:this.loadData})}),Object(a.jsx)(pt,{label:"\u5546\u54c1\u56fe\u7247\uff1a",children:Object(a.jsx)(rt,{ref:this.pw,imgs:s})}),Object(a.jsx)(pt,{label:"\u5546\u54c1\u8be6\u60c5\uff1a",labelCol:{span:2},wrapperCol:{span:20},children:Object(a.jsx)(dt,{ref:this.editor,detail:i})}),Object(a.jsx)(pt,{children:Object(a.jsx)(j.a,{type:"primary",onClick:this.submit,children:"\u63d0\u4ea4"})})]}))})}}]),n}(r.Component),mt=(n(888),n(359)),bt=mt.b.Item,ft=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={cName1:"",cName2:""},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=Object(y.a)(O.a.mark((function e(){var t,n,a,r,c,s,i,o;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.location.state.product,n=t.pCategoryId,a=t.categoryId,"0"!==n){e.next=9;break}return e.next=4,U(a);case 4:r=e.sent,c=r.data.name,this.setState({cName1:c}),e.next=15;break;case 9:return e.next=11,Promise.all([U(n),U(a)]);case 11:s=e.sent,i=s[0].data.name,o=s[1].data.name,this.setState({cName1:i,cName2:o});case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props.location.state.product,n=t.name,r=t.desc,c=t.price,s=t.imgs,i=t.detail,o=this.state,u=o.cName1,l=o.cName2,d=Object(a.jsxs)("span",{children:[Object(a.jsx)(he,{onClick:function(){return e.props.history.goBack()},children:Object(a.jsx)(tt.a,{})}),Object(a.jsx)("span",{style:{marginLeft:10},children:"\u5546\u54c1\u8be6\u60c5"})]});return Object(a.jsx)(ke.a,{title:d,className:"product-details",children:Object(a.jsxs)(mt.b,{children:[Object(a.jsxs)(bt,{children:[Object(a.jsx)("span",{className:"left",children:"\u5546\u54c1\u540d\u79f0:"}),Object(a.jsx)("span",{children:n})]}),Object(a.jsxs)(bt,{children:[Object(a.jsx)("span",{className:"left",children:"\u5546\u54c1\u63cf\u8ff0:"}),Object(a.jsx)("span",{children:r})]}),Object(a.jsxs)(bt,{children:[Object(a.jsx)("span",{className:"left",children:"\u5546\u54c1\u4ef7\u683c:"}),Object(a.jsxs)("span",{children:[c,"\u5143"]})]}),Object(a.jsxs)(bt,{children:[Object(a.jsx)("span",{className:"left",children:"\u6240\u5c5e\u5206\u7c7b:"}),Object(a.jsxs)("span",{children:[u,l?"--\x3e"+l:""]})]}),Object(a.jsxs)(bt,{children:[Object(a.jsx)("span",{className:"left",children:"\u5546\u54c1\u56fe\u7247\uff1a"}),s.map((function(e,t){return Object(a.jsx)("img",{src:Ye+e,alt:"img",className:"img"},t)}))]}),Object(a.jsxs)(bt,{children:[Object(a.jsx)("span",{className:"left",children:"\u5546\u54c1\u8be6\u60c5\uff1a"}),Object(a.jsx)("span",{dangerouslySetInnerHTML:{__html:i}})]})]})})}}]),n}(r.Component),Ot=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(a.jsxs)(h.d,{children:[Object(a.jsx)(h.b,{path:"/product",component:Qe,exact:!0}),Object(a.jsx)(h.b,{path:"/product/addupdate",component:jt}),Object(a.jsx)(h.b,{path:"/product/details",component:ft}),Object(a.jsx)(h.a,{to:"/product"})]})}}]),n}(r.Component),xt=m.a.Item,yt=ze.a.Option,gt=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).formRef=c.a.createRef(),a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this.formRef.current;this.props.setForm(e)}},{key:"shouldComponentUpdate",value:function(e,t){return e.user!=this.props.user&&(this.formRef.current.setFieldsValue({username:e.user.username,phone:e.user.phone,email:e.user.email,role_id:e.user.role_id}),!0)}},{key:"render",value:function(){var e=this.props.roles,t=this.props.user;console.log("user",t);return Object(a.jsxs)(m.a,Object(pe.a)(Object(pe.a)({},{labelCol:{span:3},wrapperCol:{span:20}}),{},{ref:this.formRef,initialValues:{username:t.username,phone:t.phone,email:t.email,role_id:t.role_id},children:[Object(a.jsx)(xt,{label:"\u7528\u6237\u540d",name:"username",children:Object(a.jsx)(b.a,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"})}),t._id?null:Object(a.jsx)(xt,{label:"\u5bc6\u7801",name:"password",children:Object(a.jsx)(b.a,{placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801"})}),Object(a.jsx)(xt,{label:"\u624b\u673a\u53f7",name:"phone",children:Object(a.jsx)(b.a,{placeholder:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7"})}),Object(a.jsx)(xt,{label:"\u90ae\u7bb1",name:"email",children:Object(a.jsx)(b.a,{placeholder:"\u8bf7\u8f93\u5165\u90ae\u7bb1"})}),Object(a.jsx)(xt,{label:"\u89d2\u8272",name:"role_id",children:Object(a.jsx)(ze.a,{placeholder:"\u8bf7\u9009\u62e9\u89d2\u8272",children:e.map((function(e){return Object(a.jsx)(yt,{value:e._id,children:e.name},e._id)}))})})]}))}}]),n}(c.a.Component),vt=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var r;return Object(o.a)(this,n),(r=t.call(this,e)).initColumns=function(){r.columns=[{title:"\u7528\u6237\u540d",dataIndex:"username"},{title:"\u90ae\u7bb1",dataIndex:"email"},{title:"\u7535\u8bdd",dataIndex:"phone"},{title:"\u6ce8\u518c\u65f6\u95f4",dataIndex:"create_time",render:ee},{title:"\u6240\u5c5e\u89d2\u8272",dataIndex:"role_id",render:function(e){return r.roleNames[e]}},{title:"\u64cd\u4f5c",render:function(e){return Object(a.jsxs)("span",{children:[Object(a.jsx)(he,{onClick:function(){return r.showUpdateUser(e)},children:"\u4fee\u6539"}),Object(a.jsx)(he,{onClick:function(){return r.DeleteUser(e)},children:"\u5220\u9664"})]})}}]},r.initRoles=function(e){r.roleNames=e.reduce((function(e,t){return e[t._id]=t.name,e}),{}),console.log("roleNames",r.roleNames)},r.showUpdateUser=function(e){r.user=e,r.setState({showState:!0})},r.addOrUpdateUser=function(){r.form.validateFields().then(function(){var e=Object(y.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.user&&(t._id=r.user._id),e.next=3,W(t);case 3:n=e.sent,r.setState({showState:!1}),0===n.status?(x.b.success("".concat(r.user?"\u4fee\u6539":"\u6dfb\u52a0","\u7528\u6237\u6210\u529f")),r.getUsers()):x.b.error(n.msg);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},r.getUsers=Object(y.a)(O.a.mark((function e(){var t,n,a,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.setState({loading:!0}),e.next=3,S("/api/manage/user/list");case 3:t=e.sent,r.setState({loading:!1}),console.log("userList",t),0===t.status&&(n=t.data,a=n.users,c=n.roles,r.initRoles(c),r.setState({users:a,roles:c}));case 7:case"end":return e.stop()}}),e)}))),r.DeleteUser=function(e){Z.a.confirm({title:"\u5220\u9664\u7528\u6237".concat(e.username,"\u5417\uff1f"),icon:Object(a.jsx)($.a,{}),okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:function(){var t=Object(y.a)(O.a.mark((function t(){var n,a;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e._id,t.next=3,S("/api/manage/user/delete",{userId:n},"POST");case 3:0===(a=t.sent).status&&(console.log("result",a),x.b.success("\u5220\u9664\u7528\u6237\u6210\u529f"),r.getUsers());case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()})},r.state={users:[],showState:!1,loading:!1,roles:[]},r}return Object(u.a)(n,[{key:"componentWillMount",value:function(){this.initColumns()}},{key:"componentDidMount",value:function(){this.getUsers()}},{key:"render",value:function(){var e=this,t=this.state,n=t.users,r=t.showState,c=t.loading,s=t.roles,i=this.user||{},o=Object(a.jsx)(j.a,{type:"primary",onClick:function(){e.user=null,e.setState({showState:!0})},children:"\u6dfb\u52a0\u7528\u6237"});return Object(a.jsxs)(ke.a,{title:o,children:[Object(a.jsx)(Ve.a,{rowKey:"_id",columns:this.columns,bordered:!0,loading:c,dataSource:n,pagination:{defaultPageSize:3,showQuickJumper:!0}}),Object(a.jsx)(Z.a,{title:i._id?"\u66f4\u6539\u7528\u6237":"\u6dfb\u52a0\u7528\u6237",visible:r,onOk:this.addOrUpdateUser,onCancel:function(){return e.setState({showState:!1})},children:Object(a.jsx)(gt,{ref:this.formRef,roles:s,user:i,setForm:function(t){e.form=t}})})]})}}]),n}(r.Component),kt=m.a.Item,wt=(ze.a.Option,function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).formRef=c.a.createRef(),a}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var e=this.formRef.current;this.props.setForm(e)}},{key:"render",value:function(){return Object(a.jsx)(m.a,{ref:this.formRef,children:Object(a.jsx)(kt,{name:"roleName",label:"\u89d2\u8272\u540d\u79f0",rules:[{required:!0,message:"\u89d2\u8272\u540d\u79f0\u5fc5\u987b\u8f93\u5165"}],children:Object(a.jsx)(b.a,{placeholder:"\u8bf7\u8f93\u5165\u89d2\u8272\u540d\u79f0"})})})}}]),n}(r.Component)),Ct=(n(890),n(358)),St=m.a.Item,Nt=Ct.a.TreeNode,It=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var r;Object(o.a)(this,n),(r=t.call(this,e)).getMenus=function(e){return e.reduce((function(e,t){return e.push(Object(a.jsx)(Nt,{title:t.title,children:t.children?r.getMenus(t.children):null},t.key)),e}),[])},r.getAuth=function(){return r.state.checkedKeys},r.onCheck=function(e){console.log("onCheck",e),r.setState({checkedKeys:e})};var c=r.props.role.menus;return r.state={checkedKeys:c},r}return Object(u.a)(n,[{key:"componentWillMount",value:function(){this.menuTreeNodes=this.getMenus(de)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=e.role.menus;this.setState({checkedKeys:t})}},{key:"render",value:function(){var e=this.props.role,t=this.state.checkedKeys;return Object(a.jsxs)("div",{children:[Object(a.jsx)(St,{label:"\u89d2\u8272\u540d\u79f0",children:Object(a.jsx)(b.a,{value:e.name,disabled:!0})}),Object(a.jsx)(St,{children:Object(a.jsx)(Ct.a,{checkable:!0,defaultExpandAll:!0,checkedKeys:t,onCheck:this.onCheck,children:this.menuTreeNodes})})]})}}]),n}(r.Component),Tt=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).initColumns=function(){a.columns=[{title:"\u89d2\u8272\u540d\u79f0",dataIndex:"name"},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"create_time",render:function(e){return ee(e)}},{title:"\u6388\u6743\u65f6\u95f4",dataIndex:"auth_time",render:ee},{title:"\u6388\u6743\u4eba",dataIndex:"auth_name"}]},a.onRow=function(e){return{onClick:function(t){a.setState({role:e})}}},a.getRoles=Object(y.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S("/api/manage/role/list");case 2:0===(t=e.sent).status&&a.setState({roles:t.data});case 4:case"end":return e.stop()}}),e)}))),a.handleCancel=function(){a.setState({isShowAdd:!1}),a.form.resetFields()},a.addRole=Object(y.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:a.form.validateFields(["roleName"]).then(function(){var e=Object(y.a)(O.a.mark((function e(t){var n,r,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.roleName,a.form.resetFields(),e.next=4,L(n);case 4:r=e.sent,a.setState({isShowAdd:!1}),0===r.status?(x.b.success("\u6dfb\u52a0\u7528\u6237\u89d2\u8272\u6210\u529f\uff01"),c=r.data,a.setState((function(e){return{roles:[].concat(Object($e.a)(e.roles),[c])}}))):x.b.success("\u6dfb\u52a0\u7528\u6237\u89d2\u8272\u5931\u8d25\uff01");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 1:case"end":return e.stop()}}),e)}))),a.updateRole=Object(y.a)(O.a.mark((function e(){var t,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("updateRole()"),t=a.auth.current.getAuth(),a.setState({isShowUpdate:!1}),(n=a.state.role).menus=t,n.auth_time=new Date,n.auth_name=z.user.username,e.next=9,V(n);case 9:0===e.sent.status?z.user.role_id===n._id?(x.b.success("\u66f4\u65b0\u5f53\u524d\u7528\u6237\u6743\u9650\u6210\u529f\uff01"),z.user={},X(),a.props.history.replace("/login")):x.b.success("\u66f4\u65b0\u7528\u6237\u6743\u9650\u6210\u529f\uff01"):x.b.error("\u66f4\u65b0\u7528\u6237\u6743\u9650\u5931\u8d25\uff01");case 11:case"end":return e.stop()}}),e)}))),a.auth=c.a.createRef(),a.state={roles:[],role:{},isShowAdd:!1,isShowUpdate:!1},a}return Object(u.a)(n,[{key:"componentWillMount",value:function(){this.initColumns()}},{key:"componentDidMount",value:function(){this.getRoles()}},{key:"render",value:function(){var e=this,t=this.state,n=t.roles,r=t.role,c=t.isShowAdd,s=t.isShowUpdate,i=Object(a.jsxs)("span",{children:[Object(a.jsx)(j.a,{type:"primary",onClick:function(){return e.setState({isShowAdd:!0})},children:"\u521b\u5efa\u89d2\u8272"}),"\xa0\xa0",Object(a.jsx)(j.a,{type:"primary",disabled:!r._id,onClick:function(){return e.setState({isShowUpdate:!0})},children:"\u8bbe\u7f6e\u89d2\u8272\u6743\u9650"})]});return Object(a.jsxs)(ke.a,{title:i,children:[Object(a.jsx)(Ve.a,{rowKey:"_id",columns:this.columns,bordered:!0,dataSource:n,rowSelection:{type:"radio",selectedRowKeys:[r._id],onSelect:function(t){return e.setState({role:t})}},onRow:this.onRow,pagination:{defaultPageSize:3}}),Object(a.jsx)(Z.a,{title:"\u6dfb\u52a0\u89d2\u8272",visible:c,onOk:this.addRole,onCancel:this.handleCancel,children:Object(a.jsx)(wt,{setForm:function(t){return e.form=t}})}),Object(a.jsx)(Z.a,{title:"\u4fee\u6539\u89d2\u8272",visible:s,onOk:this.updateRole,onCancel:function(){e.setState({isShowUpdate:!1})},children:Object(a.jsx)(It,{role:r,ref:this.auth})})]})}}]),n}(r.Component),Rt=n(172),At=n.n(Rt),_t=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={happyness:[120,200,150,80,70,110,130]},e.getOption=function(e){return{xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]},yAxis:{type:"value"},series:[{data:e,type:"bar"}]}},e.updateData=function(){e.setState((function(e){return{happyness:Object($e.a)(e.happyness).map((function(e){return e+1}))}}))},e}return Object(u.a)(n,[{key:"render",value:function(){var e=this.state.happyness,t=Object(a.jsx)(j.a,{type:"primary",onClick:this.updateData,children:"\u66f4\u65b0"});return Object(a.jsx)(ke.a,{title:t,children:Object(a.jsx)(At.a,{option:this.getOption(e)})})}}]),n}(r.Component),Pt=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={happyness:[120,200,150,80,70,110,130]},e.getOption=function(e){return{xAxis:{type:"category",data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]},yAxis:{type:"value"},series:[{data:e,type:"line"}]}},e.updateData=function(){e.setState((function(e){return{happyness:Object($e.a)(e.happyness).map((function(e){return e+1}))}}))},e}return Object(u.a)(n,[{key:"render",value:function(){var e=this.state.happyness,t=Object(a.jsx)(j.a,{type:"primary",onClick:this.updateData,children:"\u66f4\u65b0"});return Object(a.jsx)(ke.a,{title:t,children:Object(a.jsx)(At.a,{option:this.getOption(e)})})}}]),n}(r.Component),Dt=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).getOption1=function(){return{angleAxis:{type:"category",data:["\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d","\u5468\u65e5"]},radiusAxis:{},polar:{},series:[{type:"bar",data:[1,2,3,4,3,5,1],coordinateSystem:"polar",name:"A",stack:"a"},{type:"bar",data:[2,4,6,1,3,2,1],coordinateSystem:"polar",name:"B",stack:"a"},{type:"bar",data:[1,2,3,4,1,2,5],coordinateSystem:"polar",name:"C",stack:"a"}],legend:{show:!0,data:["A","B","C"]}}},e.getOption2=function(){return{title:{text:"\u67d0\u7ad9\u70b9\u7528\u6237\u8bbf\u95ee\u6765\u6e90",subtext:"\u7eaf\u5c5e\u865a\u6784",left:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"left",data:["\u76f4\u63a5\u8bbf\u95ee","\u90ae\u4ef6\u8425\u9500","\u8054\u76df\u5e7f\u544a","\u89c6\u9891\u5e7f\u544a","\u641c\u7d22\u5f15\u64ce"]},series:[{name:"\u8bbf\u95ee\u6765\u6e90",type:"pie",radius:"55%",center:["50%","60%"],data:[{value:335,name:"\u76f4\u63a5\u8bbf\u95ee"},{value:310,name:"\u90ae\u4ef6\u8425\u9500"},{value:234,name:"\u8054\u76df\u5e7f\u544a"},{value:135,name:"\u89c6\u9891\u5e7f\u544a"},{value:1548,name:"\u641c\u7d22\u5f15\u64ce"}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}},e}return Object(u.a)(n,[{key:"render",value:function(){return Object(a.jsxs)("div",{children:[Object(a.jsx)(ke.a,{title:"\u96f7\u8fbe\u56fe",children:Object(a.jsx)(At.a,{option:this.getOption1()})}),Object(a.jsx)(ke.a,{title:"\u997c\u56fe",children:Object(a.jsx)(At.a,{option:this.getOption2()})})]})}}]),n}(r.Component),Ut=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(a.jsx)("div",{children:"Order"})}}]),n}(r.Component),Ft=(n(384),n(150)),Mt=(n(385),n(84)),Lt=(n(1208),function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this;return Object(a.jsxs)(Ft.a,{className:"not-found",children:[Object(a.jsx)(Mt.a,{span:12,className:"left"}),Object(a.jsxs)(Mt.a,{span:12,className:"right",children:[Object(a.jsx)("h1",{children:"404"}),Object(a.jsx)("h2",{children:"\u62b1\u6b49\uff0c\u4f60\u8bbf\u95ee\u7684\u9875\u9762\u4e0d\u5b58\u5728"}),Object(a.jsx)("div",{children:Object(a.jsx)(j.a,{type:"primary",onClick:function(){return e.props.history.replace("/home")},children:"\u56de\u5230\u9996\u9875"})})]})]})}}]),n}(r.Component)),Vt=Q.a.Footer,Wt=Q.a.Sider,Kt=Q.a.Content,zt=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=z.user;return e&&e._id?Object(a.jsxs)(Q.a,{style:{minHeight:"100%"},children:[Object(a.jsx)(Wt,{children:Object(a.jsx)(ge,{})}),Object(a.jsxs)(Q.a,{children:[Object(a.jsx)(fe,{children:"Header"}),Object(a.jsx)(Kt,{style:{margin:20,backgroundColor:"#fff"},children:Object(a.jsxs)(h.d,{children:[Object(a.jsx)(h.a,{from:"/",exact:!0,to:"/home"}),Object(a.jsx)(h.b,{path:"/home",component:Le}),Object(a.jsx)(h.b,{path:"/category",component:Xe}),Object(a.jsx)(h.b,{path:"/product",component:Ot}),Object(a.jsx)(h.b,{path:"/user",component:vt}),Object(a.jsx)(h.b,{path:"/role",component:Tt}),Object(a.jsx)(h.b,{path:"/charts/bar",component:_t}),Object(a.jsx)(h.b,{path:"/charts/pie",component:Dt}),Object(a.jsx)(h.b,{path:"/charts/line",component:Pt}),Object(a.jsx)(h.b,{path:"/order",component:Ut}),Object(a.jsx)(h.b,{component:Lt})]})}),Object(a.jsx)(Vt,{style:{textAlign:"center",color:"#aaaaaa"},children:"\u63a8\u8350\u4f7f\u7528\u8c37\u6b4c\u6d4f\u89c8\u5668\uff0c \u53ef\u4ee5\u83b7\u5f97\u66f4\u4f73\u9875\u9762\u64cd\u4f5c\u4f53\u9a8c"})]})]}):Object(a.jsx)(h.a,{to:"/login"})}}]),n}(r.Component),Bt=function(e){Object(l.a)(n,e);var t=Object(d.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){return Object(a.jsx)(p.a,{children:Object(a.jsxs)(h.d,{children:[Object(a.jsx)(h.b,{path:"/login",component:G}),Object(a.jsx)(h.b,{path:"/",component:zt})]})})}}]),n}(r.Component),Et=n(142),Jt=n(551);var qt=Object(Et.combineReducers)({headTitle:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\u9996\u9875",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case me:return t.data;default:return e}}}),Ht=n(552),Xt=Object(Et.createStore)(qt,Object(Ht.composeWithDevTools)(Object(Et.applyMiddleware)(Jt.a))),Yt=H();z.user=Yt,i.a.render(Object(a.jsx)(je.a,{store:Xt,children:Object(a.jsx)(Bt,{})}),document.getElementById("root"))},616:function(e,t,n){},700:function(e,t,n){},701:function(e,t,n){},715:function(e,t,n){},730:function(e,t,n){},776:function(e,t,n){}},[[1209,1,2]]]);
//# sourceMappingURL=main.d9e87a63.chunk.js.map